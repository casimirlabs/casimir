"use strict";var z=Object.create;var v=Object.defineProperty;var q=Object.getOwnPropertyDescriptor;var H=Object.getOwnPropertyNames;var W=Object.getPrototypeOf,K=Object.prototype.hasOwnProperty;var V=(r,o,t)=>o in r?v(r,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[o]=t;var T=(r,o)=>()=>(o||r((o={exports:{}}).exports,o),o.exports),Y=(r,o)=>{for(var t in o)v(r,t,{get:o[t],enumerable:!0})},w=(r,o,t,i)=>{if(o&&typeof o=="object"||typeof o=="function")for(let n of H(o))!K.call(r,n)&&n!==t&&v(r,n,{get:()=>o[n],enumerable:!(i=q(o,n))||i.enumerable});return r};var j=(r,o,t)=>(t=r!=null?z(W(r)):{},w(o||!r||!r.__esModule?v(t,"default",{value:r,enumerable:!0}):t,r)),X=r=>w(v({},"__esModule",{value:!0}),r);var D=(r,o,t)=>(V(r,typeof o!="symbol"?o+"":o,t),t);var P=T(p=>{"use strict";var $=p&&p.__extends||function(){var r=function(o,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=n[s])},r(o,t)};return function(o,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(o,t);function i(){this.constructor=o}o.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),J=p&&p.__values||function(r){var o=typeof Symbol=="function"&&Symbol.iterator,t=o&&r[o],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")};p.__esModule=!0;p.serializeError=p.deserializeError=p.createCustomErrorClass=p.addCustomErrorDeserializer=void 0;var R={},U={},Q=function(r,o){U[r]=o};p.addCustomErrorDeserializer=Q;var Z=function(r){var o=function(t){$(i,t);function i(n,s,l){var u=t.call(this,n||r,l)||this;if(Object.setPrototypeOf(u,i.prototype),u.name=r,s)for(var d in s)u[d]=s[d];if(l&&ee(l)&&"cause"in l&&!("cause"in u)){var c=l.cause;u.cause=c,"stack"in c&&(u.stack=u.stack+`
CAUSE: `+c.stack)}return u}return i}(Error);return R[r]=o,o};p.createCustomErrorClass=Z;function ee(r){return typeof r=="object"}var re=function(r){if(r&&typeof r=="object"){try{if(typeof r.message=="string"){var o=JSON.parse(r.message);o.message&&o.name&&(r=o)}}catch{}var t=void 0;if(typeof r.name=="string"){var i=r.name,n=U[i];if(n)t=n(r);else{var s=i==="Error"?Error:R[i];s||(console.warn("deserializing an unknown class '"+i+"'"),s=(0,p.createCustomErrorClass)(i)),t=Object.create(s.prototype);try{for(var l in r)r.hasOwnProperty(l)&&(t[l]=r[l])}catch{}}}else typeof r.message=="string"&&(t=new Error(r.message));return t&&!t.stack&&Error.captureStackTrace&&Error.captureStackTrace(t,p.deserializeError),t}return new Error(String(r))};p.deserializeError=re;var te=function(r){return r&&(typeof r=="object"?x(r,[]):typeof r=="function"?"[Function: ".concat(r.name||"anonymous","]"):r)};p.serializeError=te;function x(r,o){var t,i,n={};o.push(r);try{for(var s=J(Object.keys(r)),l=s.next();!l.done;l=s.next()){var u=l.value,d=r[u];if(typeof d!="function"){if(!d||typeof d!="object"){n[u]=d;continue}if(o.indexOf(r[u])===-1){n[u]=x(r[u],o.slice(0));continue}n[u]="[Circular]"}}}catch(c){t={error:c}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(t)throw t.error}}return typeof r.name=="string"&&(n.name=r.name),typeof r.message=="string"&&(n.message=r.message),typeof r.stack=="string"&&(n.stack=r.stack),n}});var L=T(e=>{"use strict";var F=e&&e.__extends||function(){var r=function(o,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=n[s])},r(o,t)};return function(o,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(o,t);function i(){this.constructor=o}o.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();e.__esModule=!0;e.NoAddressesFound=e.NetworkDown=e.ManagerUninstallBTCDep=e.ManagerNotEnoughSpaceError=e.ManagerFirmwareNotEnoughSpaceError=e.ManagerDeviceLockedError=e.ManagerAppDepUninstallRequired=e.ManagerAppDepInstallRequired=e.ManagerAppRelyOnBTCError=e.ManagerAppAlreadyInstalledError=e.LedgerAPINotAvailable=e.LedgerAPIErrorWithMessage=e.LedgerAPIError=e.UnknownMCU=e.LatestMCUInstalledError=e.InvalidAddressBecauseDestinationIsAlsoSource=e.InvalidAddress=e.InvalidXRPTag=e.HardResetFail=e.FirmwareNotRecognized=e.FeeEstimationFailed=e.EthAppPleaseEnableContractData=e.EnpointConfigError=e.DeviceOnboardingStatePollingError=e.DeviceExtractOnboardingStateError=e.DisconnectedDeviceDuringOperation=e.DisconnectedDevice=e.LockedDeviceError=e.DeviceSocketNoBulkStatus=e.DeviceSocketFail=e.DeviceNameInvalid=e.DeviceHalted=e.DeviceInOSUExpected=e.DeviceOnDashboardUnexpected=e.DeviceOnDashboardExpected=e.DeviceNotGenuineError=e.DeviceGenuineSocketEarlyClose=e.DeviceAppVerifyNotSupported=e.CurrencyNotSupported=e.CashAddrNotSupported=e.CantOpenDevice=e.BtcUnmatchedApp=e.BluetoothRequired=e.AmountRequired=e.AccountNotSupported=e.AccountNameRequiredError=e.addCustomErrorDeserializer=e.createCustomErrorClass=e.deserializeError=e.serializeError=void 0;e.PairingFailed=e.SyncError=e.PendingOperation=e.DustLimit=e.FeeTooHigh=e.FeeRequired=e.FeeNotLoaded=e.CantScanQRCode=e.ETHAddressNonEIP=e.WrongAppForCurrency=e.WrongDeviceForAccount=e.WebsocketConnectionFailed=e.WebsocketConnectionError=e.DeviceShouldStayInApp=e.TransportWebUSBGestureRequired=e.TransportRaceCondition=e.TransportInterfaceNotAvailable=e.TransportOpenUserCancelled=e.UserRefusedOnDevice=e.UserRefusedAllowManager=e.UserRefusedFirmwareUpdate=e.UserRefusedAddress=e.UserRefusedDeviceNameChange=e.UpdateYourApp=e.UpdateIncorrectSig=e.UpdateIncorrectHash=e.UpdateFetchFileFail=e.UnavailableTezosOriginatedAccountSend=e.UnavailableTezosOriginatedAccountReceive=e.RecipientRequired=e.MCUNotGenuineToDashboard=e.UnexpectedBootloader=e.TimeoutTagged=e.RecommendUndelegation=e.RecommendSubAccountsToEmpty=e.PasswordIncorrectError=e.PasswordsDontMatchError=e.MaxFeeTooLow=e.PriorityFeeHigherThanMaxFee=e.PriorityFeeTooHigh=e.PriorityFeeTooLow=e.GasLessThanEstimate=e.NotSupportedLegacyAddress=e.NotEnoughGas=e.NoAccessToCamera=e.NotEnoughBalanceBecauseDestinationNotCreated=e.NotEnoughSpendableBalance=e.NotEnoughBalanceInParentAccount=e.NotEnoughBalanceToDelegate=e.NotEnoughBalance=void 0;e.TransportStatusError=e.getAltStatusMessage=e.StatusCodes=e.TransportError=e.HwTransportError=e.HwTransportErrorType=e.DBNotReset=e.DBWrongPassword=e.NoDBPathGiven=e.LanguageNotFound=e.FirmwareOrAppUpdateRequired=e.LedgerAPI5xx=e.LedgerAPI4xx=e.GenuineCheckFailed=void 0;var a=P();e.serializeError=a.serializeError;e.deserializeError=a.deserializeError;e.createCustomErrorClass=a.createCustomErrorClass;e.addCustomErrorDeserializer=a.addCustomErrorDeserializer;e.AccountNameRequiredError=(0,a.createCustomErrorClass)("AccountNameRequired");e.AccountNotSupported=(0,a.createCustomErrorClass)("AccountNotSupported");e.AmountRequired=(0,a.createCustomErrorClass)("AmountRequired");e.BluetoothRequired=(0,a.createCustomErrorClass)("BluetoothRequired");e.BtcUnmatchedApp=(0,a.createCustomErrorClass)("BtcUnmatchedApp");e.CantOpenDevice=(0,a.createCustomErrorClass)("CantOpenDevice");e.CashAddrNotSupported=(0,a.createCustomErrorClass)("CashAddrNotSupported");e.CurrencyNotSupported=(0,a.createCustomErrorClass)("CurrencyNotSupported");e.DeviceAppVerifyNotSupported=(0,a.createCustomErrorClass)("DeviceAppVerifyNotSupported");e.DeviceGenuineSocketEarlyClose=(0,a.createCustomErrorClass)("DeviceGenuineSocketEarlyClose");e.DeviceNotGenuineError=(0,a.createCustomErrorClass)("DeviceNotGenuine");e.DeviceOnDashboardExpected=(0,a.createCustomErrorClass)("DeviceOnDashboardExpected");e.DeviceOnDashboardUnexpected=(0,a.createCustomErrorClass)("DeviceOnDashboardUnexpected");e.DeviceInOSUExpected=(0,a.createCustomErrorClass)("DeviceInOSUExpected");e.DeviceHalted=(0,a.createCustomErrorClass)("DeviceHalted");e.DeviceNameInvalid=(0,a.createCustomErrorClass)("DeviceNameInvalid");e.DeviceSocketFail=(0,a.createCustomErrorClass)("DeviceSocketFail");e.DeviceSocketNoBulkStatus=(0,a.createCustomErrorClass)("DeviceSocketNoBulkStatus");e.LockedDeviceError=(0,a.createCustomErrorClass)("LockedDeviceError");e.DisconnectedDevice=(0,a.createCustomErrorClass)("DisconnectedDevice");e.DisconnectedDeviceDuringOperation=(0,a.createCustomErrorClass)("DisconnectedDeviceDuringOperation");e.DeviceExtractOnboardingStateError=(0,a.createCustomErrorClass)("DeviceExtractOnboardingStateError");e.DeviceOnboardingStatePollingError=(0,a.createCustomErrorClass)("DeviceOnboardingStatePollingError");e.EnpointConfigError=(0,a.createCustomErrorClass)("EnpointConfig");e.EthAppPleaseEnableContractData=(0,a.createCustomErrorClass)("EthAppPleaseEnableContractData");e.FeeEstimationFailed=(0,a.createCustomErrorClass)("FeeEstimationFailed");e.FirmwareNotRecognized=(0,a.createCustomErrorClass)("FirmwareNotRecognized");e.HardResetFail=(0,a.createCustomErrorClass)("HardResetFail");e.InvalidXRPTag=(0,a.createCustomErrorClass)("InvalidXRPTag");e.InvalidAddress=(0,a.createCustomErrorClass)("InvalidAddress");e.InvalidAddressBecauseDestinationIsAlsoSource=(0,a.createCustomErrorClass)("InvalidAddressBecauseDestinationIsAlsoSource");e.LatestMCUInstalledError=(0,a.createCustomErrorClass)("LatestMCUInstalledError");e.UnknownMCU=(0,a.createCustomErrorClass)("UnknownMCU");e.LedgerAPIError=(0,a.createCustomErrorClass)("LedgerAPIError");e.LedgerAPIErrorWithMessage=(0,a.createCustomErrorClass)("LedgerAPIErrorWithMessage");e.LedgerAPINotAvailable=(0,a.createCustomErrorClass)("LedgerAPINotAvailable");e.ManagerAppAlreadyInstalledError=(0,a.createCustomErrorClass)("ManagerAppAlreadyInstalled");e.ManagerAppRelyOnBTCError=(0,a.createCustomErrorClass)("ManagerAppRelyOnBTC");e.ManagerAppDepInstallRequired=(0,a.createCustomErrorClass)("ManagerAppDepInstallRequired");e.ManagerAppDepUninstallRequired=(0,a.createCustomErrorClass)("ManagerAppDepUninstallRequired");e.ManagerDeviceLockedError=(0,a.createCustomErrorClass)("ManagerDeviceLocked");e.ManagerFirmwareNotEnoughSpaceError=(0,a.createCustomErrorClass)("ManagerFirmwareNotEnoughSpace");e.ManagerNotEnoughSpaceError=(0,a.createCustomErrorClass)("ManagerNotEnoughSpace");e.ManagerUninstallBTCDep=(0,a.createCustomErrorClass)("ManagerUninstallBTCDep");e.NetworkDown=(0,a.createCustomErrorClass)("NetworkDown");e.NoAddressesFound=(0,a.createCustomErrorClass)("NoAddressesFound");e.NotEnoughBalance=(0,a.createCustomErrorClass)("NotEnoughBalance");e.NotEnoughBalanceToDelegate=(0,a.createCustomErrorClass)("NotEnoughBalanceToDelegate");e.NotEnoughBalanceInParentAccount=(0,a.createCustomErrorClass)("NotEnoughBalanceInParentAccount");e.NotEnoughSpendableBalance=(0,a.createCustomErrorClass)("NotEnoughSpendableBalance");e.NotEnoughBalanceBecauseDestinationNotCreated=(0,a.createCustomErrorClass)("NotEnoughBalanceBecauseDestinationNotCreated");e.NoAccessToCamera=(0,a.createCustomErrorClass)("NoAccessToCamera");e.NotEnoughGas=(0,a.createCustomErrorClass)("NotEnoughGas");e.NotSupportedLegacyAddress=(0,a.createCustomErrorClass)("NotSupportedLegacyAddress");e.GasLessThanEstimate=(0,a.createCustomErrorClass)("GasLessThanEstimate");e.PriorityFeeTooLow=(0,a.createCustomErrorClass)("PriorityFeeTooLow");e.PriorityFeeTooHigh=(0,a.createCustomErrorClass)("PriorityFeeTooHigh");e.PriorityFeeHigherThanMaxFee=(0,a.createCustomErrorClass)("PriorityFeeHigherThanMaxFee");e.MaxFeeTooLow=(0,a.createCustomErrorClass)("MaxFeeTooLow");e.PasswordsDontMatchError=(0,a.createCustomErrorClass)("PasswordsDontMatch");e.PasswordIncorrectError=(0,a.createCustomErrorClass)("PasswordIncorrect");e.RecommendSubAccountsToEmpty=(0,a.createCustomErrorClass)("RecommendSubAccountsToEmpty");e.RecommendUndelegation=(0,a.createCustomErrorClass)("RecommendUndelegation");e.TimeoutTagged=(0,a.createCustomErrorClass)("TimeoutTagged");e.UnexpectedBootloader=(0,a.createCustomErrorClass)("UnexpectedBootloader");e.MCUNotGenuineToDashboard=(0,a.createCustomErrorClass)("MCUNotGenuineToDashboard");e.RecipientRequired=(0,a.createCustomErrorClass)("RecipientRequired");e.UnavailableTezosOriginatedAccountReceive=(0,a.createCustomErrorClass)("UnavailableTezosOriginatedAccountReceive");e.UnavailableTezosOriginatedAccountSend=(0,a.createCustomErrorClass)("UnavailableTezosOriginatedAccountSend");e.UpdateFetchFileFail=(0,a.createCustomErrorClass)("UpdateFetchFileFail");e.UpdateIncorrectHash=(0,a.createCustomErrorClass)("UpdateIncorrectHash");e.UpdateIncorrectSig=(0,a.createCustomErrorClass)("UpdateIncorrectSig");e.UpdateYourApp=(0,a.createCustomErrorClass)("UpdateYourApp");e.UserRefusedDeviceNameChange=(0,a.createCustomErrorClass)("UserRefusedDeviceNameChange");e.UserRefusedAddress=(0,a.createCustomErrorClass)("UserRefusedAddress");e.UserRefusedFirmwareUpdate=(0,a.createCustomErrorClass)("UserRefusedFirmwareUpdate");e.UserRefusedAllowManager=(0,a.createCustomErrorClass)("UserRefusedAllowManager");e.UserRefusedOnDevice=(0,a.createCustomErrorClass)("UserRefusedOnDevice");e.TransportOpenUserCancelled=(0,a.createCustomErrorClass)("TransportOpenUserCancelled");e.TransportInterfaceNotAvailable=(0,a.createCustomErrorClass)("TransportInterfaceNotAvailable");e.TransportRaceCondition=(0,a.createCustomErrorClass)("TransportRaceCondition");e.TransportWebUSBGestureRequired=(0,a.createCustomErrorClass)("TransportWebUSBGestureRequired");e.DeviceShouldStayInApp=(0,a.createCustomErrorClass)("DeviceShouldStayInApp");e.WebsocketConnectionError=(0,a.createCustomErrorClass)("WebsocketConnectionError");e.WebsocketConnectionFailed=(0,a.createCustomErrorClass)("WebsocketConnectionFailed");e.WrongDeviceForAccount=(0,a.createCustomErrorClass)("WrongDeviceForAccount");e.WrongAppForCurrency=(0,a.createCustomErrorClass)("WrongAppForCurrency");e.ETHAddressNonEIP=(0,a.createCustomErrorClass)("ETHAddressNonEIP");e.CantScanQRCode=(0,a.createCustomErrorClass)("CantScanQRCode");e.FeeNotLoaded=(0,a.createCustomErrorClass)("FeeNotLoaded");e.FeeRequired=(0,a.createCustomErrorClass)("FeeRequired");e.FeeTooHigh=(0,a.createCustomErrorClass)("FeeTooHigh");e.DustLimit=(0,a.createCustomErrorClass)("DustLimit");e.PendingOperation=(0,a.createCustomErrorClass)("PendingOperation");e.SyncError=(0,a.createCustomErrorClass)("SyncError");e.PairingFailed=(0,a.createCustomErrorClass)("PairingFailed");e.GenuineCheckFailed=(0,a.createCustomErrorClass)("GenuineCheckFailed");e.LedgerAPI4xx=(0,a.createCustomErrorClass)("LedgerAPI4xx");e.LedgerAPI5xx=(0,a.createCustomErrorClass)("LedgerAPI5xx");e.FirmwareOrAppUpdateRequired=(0,a.createCustomErrorClass)("FirmwareOrAppUpdateRequired");e.LanguageNotFound=(0,a.createCustomErrorClass)("LanguageNotFound");e.NoDBPathGiven=(0,a.createCustomErrorClass)("NoDBPathGiven");e.DBWrongPassword=(0,a.createCustomErrorClass)("DBWrongPassword");e.DBNotReset=(0,a.createCustomErrorClass)("DBNotReset");var oe;(function(r){r[r.Unknown=0]="Unknown",r[r.BleLocationServicesDisabled=1]="BleLocationServicesDisabled",r[r.BleBluetoothUnauthorized=2]="BleBluetoothUnauthorized",r[r.BleScanStartFailed=3]="BleScanStartFailed"})(oe=e.HwTransportErrorType||(e.HwTransportErrorType={}));var ae=function(r){F(o,r);function o(t,i){var n=r.call(this,i)||this;return n.name="HwTransportError",n.type=t,Object.setPrototypeOf(n,o.prototype),n}return o}(Error);e.HwTransportError=ae;var b=function(r){F(o,r);function o(t,i){var n=this,s="TransportError";return n=r.call(this,t||s)||this,n.name=s,n.message=t,n.stack=new Error().stack,n.id=i,n}return o}(Error);e.TransportError=b;(0,a.addCustomErrorDeserializer)("TransportError",function(r){return new b(r.message,r.id)});e.StatusCodes={ACCESS_CONDITION_NOT_FULFILLED:38916,ALGORITHM_NOT_SUPPORTED:38020,CLA_NOT_SUPPORTED:28160,CODE_BLOCKED:38976,CODE_NOT_INITIALIZED:38914,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,CONDITIONS_OF_USE_NOT_SATISFIED:27013,CONTRADICTION_INVALIDATION:38928,CONTRADICTION_SECRET_CODE_STATUS:38920,CUSTOM_IMAGE_BOOTLOADER:26159,CUSTOM_IMAGE_EMPTY:26158,FILE_ALREADY_EXISTS:27273,FILE_NOT_FOUND:37892,GP_AUTH_FAILED:25344,HALTED:28586,INCONSISTENT_FILE:37896,INCORRECT_DATA:27264,INCORRECT_LENGTH:26368,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,INVALID_KCV:38021,INVALID_OFFSET:37890,LICENSING:28482,LOCKED_DEVICE:21781,MAX_VALUE_REACHED:38992,MEMORY_PROBLEM:37440,MISSING_CRITICAL_PARAMETER:26624,NO_EF_SELECTED:37888,NOT_ENOUGH_MEMORY_SPACE:27268,OK:36864,PIN_REMAINING_ATTEMPTS:25536,REFERENCED_DATA_NOT_FOUND:27272,SECURITY_STATUS_NOT_SATISFIED:27010,TECHNICAL_PROBLEM:28416,UNKNOWN_APDU:27906,USER_REFUSED_ON_DEVICE:21761};function M(r){switch(r){case 26368:return"Incorrect length";case 26624:return"Missing critical parameter";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received";case 21781:return"Locked device"}if(28416<=r&&r<=28671)return"Internal error, please report"}e.getAltStatusMessage=M;function N(r){var o=Object.keys(e.StatusCodes).find(function(s){return e.StatusCodes[s]===r})||"UNKNOWN_ERROR",t=M(r)||o,i=r.toString(16),n="Ledger device: ".concat(t," (0x").concat(i,")");if(r===e.StatusCodes.LOCKED_DEVICE)throw new e.LockedDeviceError(n);this.name="TransportStatusError",this.message=n,this.stack=new Error().stack,this.statusCode=r,this.statusText=o}e.TransportStatusError=N;N.prototype=new Error;(0,a.addCustomErrorDeserializer)("TransportStatusError",function(r){return new N(r.statusCode)})});var k=T(E=>{"use strict";var A=E&&E.__awaiter||function(r,o,t,i){function n(s){return s instanceof t?s:new t(function(l){l(s)})}return new(t||(t=Promise))(function(s,l){function u(C){try{c(i.next(C))}catch(h){l(h)}}function d(C){try{c(i.throw(C))}catch(h){l(h)}}function c(C){C.done?s(C.value):n(C.value).then(u,d)}c((i=i.apply(r,o||[])).next())})},S=E&&E.__generator||function(r,o){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,l;return l={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function u(c){return function(C){return d([c,C])}}function d(c){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,n&&(s=c[0]&2?n.return:c[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,c[1])).done)return s;switch(n=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,n=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){t.label=c[1];break}if(c[0]===6&&t.label<s[1]){t.label=s[1],s=c;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(c);break}s[2]&&t.ops.pop(),t.trys.pop();continue}c=o.call(r,t)}catch(C){c=[6,C],n=0}finally{i=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},B=E&&E.__values||function(r){var o=typeof Symbol=="function"&&Symbol.iterator,t=o&&r[o],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")},ne=E&&E.__read||function(r,o){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var i=t.call(r),n,s=[],l;try{for(;(o===void 0||o-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(u){l={error:u}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(l)throw l.error}}return s},se=E&&E.__spreadArray||function(r,o,t){if(t||arguments.length===2)for(var i=0,n=o.length,s;i<n;i++)(s||!(i in o))&&(s||(s=Array.prototype.slice.call(o,0,i)),s[i]=o[i]);return r.concat(s||Array.prototype.slice.call(o))},ie=E&&E.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};E.__esModule=!0;E.getAltStatusMessage=E.StatusCodes=E.TransportStatusError=E.TransportError=void 0;var ce=ie(require("events")),f=L();E.TransportError=f.TransportError;E.StatusCodes=f.StatusCodes;E.getAltStatusMessage=f.getAltStatusMessage;E.TransportStatusError=f.TransportStatusError;var ue=function(){function r(){var o=this;this.exchangeTimeout=3e4,this.unresponsiveTimeout=15e3,this.deviceModel=null,this._events=new ce.default,this.send=function(t,i,n,s,l,u){return l===void 0&&(l=Buffer.alloc(0)),u===void 0&&(u=[f.StatusCodes.OK]),A(o,void 0,void 0,function(){var d,c;return S(this,function(C){switch(C.label){case 0:if(l.length>=256)throw new f.TransportError("data.length exceed 256 bytes limit. Got: "+l.length,"DataLengthTooBig");return[4,this.exchange(Buffer.concat([Buffer.from([t,i,n,s]),Buffer.from([l.length]),l]))];case 1:if(d=C.sent(),c=d.readUInt16BE(d.length-2),!u.some(function(h){return h===c}))throw new f.TransportStatusError(c);return[2,d]}})})},this.exchangeAtomicImpl=function(t){return A(o,void 0,void 0,function(){var i,n,s,l,u,d=this;return S(this,function(c){switch(c.label){case 0:if(this.exchangeBusyPromise)throw new f.TransportRaceCondition("An action was already pending on the Ledger device. Please deny or reconnect.");n=new Promise(function(C){i=C}),this.exchangeBusyPromise=n,s=!1,l=setTimeout(function(){s=!0,d.emit("unresponsive")},this.unresponsiveTimeout),c.label=1;case 1:return c.trys.push([1,,3,4]),[4,t()];case 2:return u=c.sent(),s&&this.emit("responsive"),[2,u];case 3:return clearTimeout(l),i&&i(),this.exchangeBusyPromise=null,[7];case 4:return[2]}})})},this._appAPIlock=null}return r.prototype.exchange=function(o){throw new Error("exchange not implemented")},r.prototype.exchangeBulk=function(o,t){var i=this,n=!1,s=function(){n=!0},l=function(){return A(i,void 0,void 0,function(){var u,d,c,C,h,_,y,O;return S(this,function(g){switch(g.label){case 0:if(n)return[2];g.label=1;case 1:g.trys.push([1,6,7,8]),u=B(o),d=u.next(),g.label=2;case 2:return d.done?[3,5]:(c=d.value,[4,this.exchange(c)]);case 3:if(C=g.sent(),n)return[2];if(h=C.readUInt16BE(C.length-2),h!==f.StatusCodes.OK)throw new f.TransportStatusError(h);t.next(C),g.label=4;case 4:return d=u.next(),[3,2];case 5:return[3,8];case 6:return _=g.sent(),y={error:_},[3,8];case 7:try{d&&!d.done&&(O=u.return)&&O.call(u)}finally{if(y)throw y.error}return[7];case 8:return[2]}})})};return l().then(function(){return!n&&t.complete()},function(u){return!n&&t.error(u)}),{unsubscribe:s}},r.prototype.setScrambleKey=function(o){},r.prototype.close=function(){return Promise.resolve()},r.prototype.on=function(o,t){this._events.on(o,t)},r.prototype.off=function(o,t){this._events.removeListener(o,t)},r.prototype.emit=function(o){for(var t,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];(t=this._events).emit.apply(t,se([o],ne(i),!1))},r.prototype.setDebugMode=function(){console.warn("setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.")},r.prototype.setExchangeTimeout=function(o){this.exchangeTimeout=o},r.prototype.setExchangeUnresponsiveTimeout=function(o){this.unresponsiveTimeout=o},r.create=function(o,t){var i=this;return o===void 0&&(o=3e3),new Promise(function(n,s){var l=!1,u=i.listen({next:function(c){l=!0,u&&u.unsubscribe(),d&&clearTimeout(d),i.open(c.descriptor,o).then(n,s)},error:function(c){d&&clearTimeout(d),s(c)},complete:function(){d&&clearTimeout(d),l||s(new f.TransportError(i.ErrorMessage_NoDeviceFound,"NoDeviceFound"))}}),d=t?setTimeout(function(){u.unsubscribe(),s(new f.TransportError(i.ErrorMessage_ListenTimeout,"ListenTimeout"))},t):null})},r.prototype.decorateAppAPIMethods=function(o,t,i){var n,s;try{for(var l=B(t),u=l.next();!u.done;u=l.next()){var d=u.value;o[d]=this.decorateAppAPIMethod(d,o[d],o,i)}}catch(c){n={error:c}}finally{try{u&&!u.done&&(s=l.return)&&s.call(l)}finally{if(n)throw n.error}}},r.prototype.decorateAppAPIMethod=function(o,t,i,n){var s=this;return function(){for(var l=[],u=0;u<arguments.length;u++)l[u]=arguments[u];return A(s,void 0,void 0,function(){var d;return S(this,function(c){switch(c.label){case 0:if(d=this._appAPIlock,d)return[2,Promise.reject(new f.TransportError("Ledger Device is busy (lock "+d+")","TransportLocked"))];c.label=1;case 1:return c.trys.push([1,,3,4]),this._appAPIlock=o,this.setScrambleKey(n),[4,t.apply(i,l)];case 2:return[2,c.sent()];case 3:return this._appAPIlock=null,[7];case 4:return[2]}})})}},r.ErrorMessage_ListenTimeout="No Ledger device found (timeout)",r.ErrorMessage_NoDeviceFound="No Ledger device found",r}();E.default=ue});var le={};Y(le,{default:()=>m});module.exports=X(le);var G=j(k());var I=class extends G.default{baseURL;eventStream;constructor(o){super(),this.baseURL=o}button=async o=>{let t={action:"press-and-release"};await fetch(`${this.baseURL}/button/${o}`,{method:"POST",body:JSON.stringify(t)})};async exchange(o){let t=o.toString("hex"),n=await(await fetch(`${this.baseURL}/apdu`,{method:"POST",body:JSON.stringify({data:t})})).json(),{data:s}=n;return Buffer.from(s,"hex")}async close(){return this.eventStream.close(),Promise.resolve()}},m=I;D(m,"isSupported",()=>Promise.resolve(!0)),D(m,"list",()=>Promise.resolve([])),D(m,"listen",()=>({unsubscribe:()=>{}})),D(m,"open",async o=>{try{o=o||"http://127.0.0.1:5000";let t=new I(o),i=new EventSource(`${o}/events?stream=true`);return t.eventStream=i,t}catch(t){throw console.log(t),t}});0&&(module.exports={});
//# sourceMappingURL=index.js.map
